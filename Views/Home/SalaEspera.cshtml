@{
    ViewData["Title"] = "Home Page";
}

<main class="pagina-login-register">
<h1 class="titulo">Nehuentados</h1>
<section class="seccion-configurar">
    <div class="container">
        <h1>Jugadores</h1>
        <div class="contenedor-jugadores"></div>
        @if(ViewBag.jugador.IdJugador == 1) 
        {
            <button class="login-boton" style="margin-top: 4%" id="boton-iniciar">Iniciar</button>
        }
    </div>
</section>
<h1 class="codigo">Código: @ViewBag.idPartida</h1>
</main>

<script>

let buclenombre, bucleinicio;
let boton = document.getElementById("boton-iniciar");
document.addEventListener('DOMContentLoaded', function() {
                ChequearNombres();
                buclenombre=setInterval(ChequearNombres,3000);
                bucleinicio=setInterval(ChequearInicio,1000);
                
        });

        boton.addEventListener("click", function (){
                $.ajax({
                    url: '@Url.Action("EmpezarPartida", "Home")',
                    type: 'GET',
                    data: {},
                    success: function(data){
                        console.log(data.empezada)
                    },
                    error: function () {
                        alert('Error al actualizar los jugadores');
                    }
                });
                })
        

    function ChequearNombres(){
        $.ajax({
                    url: '@Url.Action("ObtenerNombreJugador", "Home")',
                    type: 'GET',
                    data: {},
                    success: function (data) {
                        $('.contenedor-jugadores').empty();
                        $('.contenedor-jugadores').append('<div><p>' + data.jug1 + '</p></div>');
                        if(data.jug2 != "")
                        {
                            $('.contenedor-jugadores').append('<div><p>' + data.jug2 + '</p></div>');
                        }
                    },
                    error: function () {
                        alert('Error al actualizar los jugadores');
                    }
                });
    }
    function ChequearInicio(){
        console.log("hola");
        $.ajax({
                    url: '@Url.Action("YaEmpezoLaPartida", "Home")',
                    type: 'GET',
                    data: {},
                    success: function (data) {
                        console.log(data.empezo);
                        if(data.empezo==1){
                            console.log("entro bien adentro");
                             window.location.href='/Home/EmpezarPartida';
                        }

                    },
                    error: function () {
                        alert('Error al chequear si inició');
                    }
                });
    }
</script>